main start at this time 1623600921.032504
before load_ogb step Time(s): 0.0017
load ogbn-products
-------------------------------------------------------------data = DglNodePropPredDataset(name=name)*************************** step Time(s): 1.6517
finish loading ogbn-products
-------------------------------------------------------------splitted_idx = data.get_idx_split()*************************** step Time(s): 0.2878
-------------------------------------------------------------graph, labels = data[0]*************************** step Time(s): 0.0000
tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]])
(Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={}), tensor([[0],
        [1],
        [2],
        ...,
        [8],
        [2],
        [4]]))
Graph(num_nodes=2449029, num_edges=123718280,
      ndata_schemes={'feat': Scheme(shape=(100,), dtype=torch.float32)}
      edata_schemes={})
-------------------------------------------------------------labels = labels[:, 0]*************************** step Time(s): 0.0013
-------------------------------------------------------------graph.ndata['features'] = graph.ndata['feat']*************************** step Time(s): 0.0002
-------------------------------------------------graph.ndata['labels'] = labels****************** step Time(s): 0.0000
-------------------------------------------------train_nid, val_nid, test_nid = splitted_idx****************** step Time(s): 0.0709
-------------------------------------------------end of load ogb****************** step Time(s): 0.0022
finish constructing ogbn-products
load ogb-products time total: 2.0140888690948486
#nodes: 2449029
#edges: 123718280
#classes: 47
after load_ogb step Time(s): 2.0150
after inductive else step Time(s): 0.0001
after label step Time(s): 3.7004
after train_g.create_formats_() step Time(s): 1.5512
after pack data step Time(s): 0.0000
 start_run step Time(s): 0.0001
 unpack data step Time(s): 0.0000
 train_mask step Time(s): 0.0086
val_mask and  test_mask step Time(s): 0.0176
in_feats 100
train_labels.shape torch.Size([2449029])
 create a sampler instance step Time(s): 0.0001
args.batch_size 12289
 create a data loader instance step Time(s): 0.0035
 create a model instance step Time(s): 0.0036
SAGE(
  (layers): ModuleList(
    (0): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(100, 100, batch_first=True)
      (fc_self): Linear(in_features=100, out_features=16, bias=False)
      (fc_neigh): Linear(in_features=100, out_features=16, bias=False)
    )
    (1): SAGEConv(
      (feat_drop): Dropout(p=0.0, inplace=False)
      (lstm): LSTM(16, 16, batch_first=True)
      (fc_self): Linear(in_features=16, out_features=47, bias=False)
      (fc_neigh): Linear(in_features=16, out_features=47, bias=False)
    )
  )
  (dropout): Dropout(p=0.5, inplace=False)
)
 create an optimizer instance step Time(s): 0.0020

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 2.30517578125GB	
Max Memory Allocated 0.9309115409851074  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 2.67626953125GB	
Max Memory Allocated 1.2877330780029297  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 2.73291015625GB	
Max Memory Allocated 1.2877330780029297  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 18.41455078125GB	
Max Memory Allocated 16.61372184753418  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 18.41455078125GB	
Max Memory Allocated 16.61372184753418  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 18.43017578125GB	
Max Memory Allocated 16.61372184753418  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 18.43017578125GB	
Max Memory Allocated 16.61372184753418  GigaBytes

Epoch 00000 | Step 00000 | Loss 0.2986 | Train Acc 0.0332 | Speed (samples/sec) nan | GPU 17012.5 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 18.39111328125GB	
Max Memory Allocated 16.61372184753418  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 18.39111328125GB	
Max Memory Allocated 16.61372184753418  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 18.41455078125GB	
Max Memory Allocated 16.61372184753418  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.30517578125GB	
Max Memory Allocated 16.617688179016113  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.29541015625GB	
Max Memory Allocated 16.617688179016113  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.29931640625GB	
Max Memory Allocated 16.617688179016113  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.29931640625GB	
Max Memory Allocated 16.617688179016113  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.26025390625GB	
Max Memory Allocated 16.617688179016113  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.26025390625GB	
Max Memory Allocated 16.617688179016113  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.28369140625GB	
Max Memory Allocated 16.617688179016113  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 21.06298828125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 21.05126953125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.659878730773926  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 21.03955078125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 21.06298828125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 21.05322265625GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.659878730773926  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 21.03955078125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 21.06298828125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 21.05322265625GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.659878730773926  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 21.03955078125GB	
Max Memory Allocated 16.659878730773926  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 21.06298828125GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 21.05322265625GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.6635160446167  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 21.03759765625GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 21.06298828125GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 21.05322265625GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 21.05517578125GB	
Max Memory Allocated 16.6635160446167  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 21.01611328125GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 21.03955078125GB	
Max Memory Allocated 16.6635160446167  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 29.81298828125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 29.80322265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 29.80517578125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 29.80517578125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 29.76611328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 29.76611328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 29.78759765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 29.81103515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 29.80126953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 29.80322265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 29.80322265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 29.76416015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 29.76416015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 29.78759765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 29.81103515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 29.80322265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 29.80517578125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 29.80517578125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 29.76611328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 29.76611328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 29.78759765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67236328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68212890625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

avg iteration(step) data from cpu to GPU time:17.99499078 ms
avg iteration GPU training time:310.66695890 ms
avg iteration (step) total cpu time:341.20746092 ms
Epoch cpu Time(s): 8.6364

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

Epoch 00001 | Step 00000 | Loss 0.0754 | Train Acc 0.6730 | Speed (samples/sec) 33223.6337 | GPU 17113.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68212890625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67236328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67236328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67236328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67236328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

avg iteration(step) data from cpu to GPU time:17.42712714 ms
avg iteration GPU training time:300.78298673 ms
avg iteration (step) total cpu time:335.14807441 ms
Epoch cpu Time(s): 7.8247

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67236328125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

Epoch 00002 | Step 00000 | Loss 0.0527 | Train Acc 0.7755 | Speed (samples/sec) 33645.9004 | GPU 17113.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63525390625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.65869140625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66259765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66259765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66259765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66259765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68408203125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63720703125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66259765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66259765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67431640625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66259765625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 30.68603515625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 30.67626953125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 30.67822265625GB	
Max Memory Allocated 16.71230983734131  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 30.63916015625GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 30.66064453125GB	
Max Memory Allocated 16.71230983734131  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

avg iteration(step) data from cpu to GPU time:21.99147051 ms
avg iteration GPU training time:300.38088157 ms
avg iteration (step) total cpu time:350.34845092 ms
Epoch cpu Time(s): 7.9224

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

Epoch 00003 | Step 00000 | Loss 0.0385 | Train Acc 0.8496 | Speed (samples/sec) 33756.4131 | GPU 17157.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

avg iteration(step) data from cpu to GPU time:20.27508961 ms
avg iteration GPU training time:315.67074585 ms
avg iteration (step) total cpu time:349.43322702 ms
Epoch cpu Time(s): 7.7552

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

Epoch 00004 | Step 00000 | Loss 0.0332 | Train Acc 0.8696 | Speed (samples/sec) 33605.7419 | GPU 17157.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

avg iteration(step) data from cpu to GPU time:17.21220086 ms
avg iteration GPU training time:310.44243275 ms
avg iteration (step) total cpu time:341.84913202 ms
Epoch cpu Time(s): 8.0178

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

Epoch 00005 | Step 00000 | Loss 0.0278 | Train Acc 0.8896 | Speed (samples/sec) 33673.3871 | GPU 17157.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

avg iteration(step) data from cpu to GPU time:19.13119420 ms
avg iteration GPU training time:334.09152222 ms
avg iteration (step) total cpu time:366.28989740 ms
Epoch cpu Time(s): 8.0068

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

Epoch 00006 | Step 00000 | Loss 0.0262 | Train Acc 0.8912 | Speed (samples/sec) 33399.9610 | GPU 17157.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

avg iteration(step) data from cpu to GPU time:17.91938886 ms
avg iteration GPU training time:349.63350053 ms
avg iteration (step) total cpu time:379.72172824 ms
Epoch cpu Time(s): 8.0805

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

Epoch 00007 | Step 00000 | Loss 0.0246 | Train Acc 0.8973 | Speed (samples/sec) 33112.9714 | GPU 17157.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

avg iteration(step) data from cpu to GPU time:17.79163335 ms
avg iteration GPU training time:306.85041116 ms
avg iteration (step) total cpu time:337.33519641 ms
Epoch cpu Time(s): 7.6600

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

Epoch 00008 | Step 00000 | Loss 0.0234 | Train Acc 0.9034 | Speed (samples/sec) 33229.4793 | GPU 17157.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57666015625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

avg iteration(step) data from cpu to GPU time:19.26557654 ms
avg iteration GPU training time:315.88533436 ms
avg iteration (step) total cpu time:350.48638691 ms
Epoch cpu Time(s): 7.9124

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

Epoch 00009 | Step 00000 | Loss 0.0238 | Train Acc 0.9027 | Speed (samples/sec) 33172.7005 | GPU 17157.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57275390625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

avg iteration(step) data from cpu to GPU time:18.46876803 ms
avg iteration GPU training time:313.12734985 ms
avg iteration (step) total cpu time:345.00375661 ms
Epoch cpu Time(s): 7.7318

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56298828125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

Epoch 00010 | Step 00000 | Loss 0.0217 | Train Acc 0.9090 | Speed (samples/sec) 33214.8116 | GPU 17157.2 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.55126953125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56689453125GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52783203125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 31.57470703125GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 31.56494140625GB	
Max Memory Allocated 16.75510597229004  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 31.52587890625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 31.54931640625GB	
Max Memory Allocated 16.75510597229004  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 18.56298828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 18.51611328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 18.51611328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 18.53955078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 18.56298828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 18.55322265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 18.51611328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 18.51611328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 18.53955078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 18.56298828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 18.55322265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 18.51611328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 18.51611328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 18.53759765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 18.56103515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 18.55126953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 18.55322265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 18.55322265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 18.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 18.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 18.53759765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 18.56298828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 18.55517578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 18.51611328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 18.51611328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 18.53759765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 18.65087890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 18.63916015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 18.64111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 18.64111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 18.60205078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 18.60205078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 18.62548828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 18.64892578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 18.64111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 18.64111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 18.64111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 18.60205078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 18.60205078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 18.62548828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 18.65087890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 18.64111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 18.64111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 18.64111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 18.60205078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 18.60205078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 18.62548828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.50830078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.69517673 ms
avg iteration GPU training time:350.55689309 ms
avg iteration (step) total cpu time:381.85739517 ms
Epoch cpu Time(s): 8.2115

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00011 | Step 00000 | Loss 0.0233 | Train Acc 0.9019 | Speed (samples/sec) 33186.3588 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.50830078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.51806640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.50830078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.51806640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.51806640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.50830078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.50830078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.90453512 ms
avg iteration GPU training time:342.06003640 ms
avg iteration (step) total cpu time:375.57747147 ms
Epoch cpu Time(s): 8.0943

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00012 | Step 00000 | Loss 0.0218 | Train Acc 0.9072 | Speed (samples/sec) 33045.1329 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.51806640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.50830078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.51806640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.51806640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.50830078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.14364797 ms
avg iteration GPU training time:318.40847223 ms
avg iteration (step) total cpu time:351.01392052 ms
Epoch cpu Time(s): 7.8040

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00013 | Step 00000 | Loss 0.0208 | Train Acc 0.9128 | Speed (samples/sec) 33059.4613 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.51806640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.51806640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47119140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.51806640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49462890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.58142558 ms
avg iteration GPU training time:317.15273493 ms
avg iteration (step) total cpu time:349.32721745 ms
Epoch cpu Time(s): 7.8404

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00014 | Step 00000 | Loss 0.0204 | Train Acc 0.9128 | Speed (samples/sec) 33057.8351 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.30456699 ms
avg iteration GPU training time:332.15443282 ms
avg iteration (step) total cpu time:367.75599826 ms
Epoch cpu Time(s): 8.0824

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00015 | Step 00000 | Loss 0.0206 | Train Acc 0.9112 | Speed (samples/sec) 32966.5810 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.69608706 ms
avg iteration GPU training time:316.44290439 ms
avg iteration (step) total cpu time:350.32536767 ms
Epoch cpu Time(s): 7.9053

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00016 | Step 00000 | Loss 0.0203 | Train Acc 0.9111 | Speed (samples/sec) 32932.7687 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.10386033 ms
avg iteration GPU training time:314.29592341 ms
avg iteration (step) total cpu time:346.06042775 ms
Epoch cpu Time(s): 7.8087

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00017 | Step 00000 | Loss 0.0189 | Train Acc 0.9195 | Speed (samples/sec) 32968.2881 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52392578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:20.05951994 ms
avg iteration GPU training time:314.82052612 ms
avg iteration (step) total cpu time:348.85889834 ms
Epoch cpu Time(s): 7.7912

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00018 | Step 00000 | Loss 0.0196 | Train Acc 0.9174 | Speed (samples/sec) 32994.6753 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:21.33206107 ms
avg iteration GPU training time:322.52346802 ms
avg iteration (step) total cpu time:357.19596256 ms
Epoch cpu Time(s): 7.8663

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00019 | Step 00000 | Loss 0.0195 | Train Acc 0.9185 | Speed (samples/sec) 32993.1050 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.09363521 ms
avg iteration GPU training time:319.00469971 ms
avg iteration (step) total cpu time:350.08447820 ms
Epoch cpu Time(s): 7.9841

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00020 | Step 00000 | Loss 0.0189 | Train Acc 0.9163 | Speed (samples/sec) 32980.1127 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.21007104 ms
avg iteration GPU training time:314.29997670 ms
avg iteration (step) total cpu time:345.37059611 ms
Epoch cpu Time(s): 7.8240

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00021 | Step 00000 | Loss 0.0178 | Train Acc 0.9220 | Speed (samples/sec) 32986.8676 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.38240034 ms
avg iteration GPU training time:323.59832764 ms
avg iteration (step) total cpu time:355.46409000 ms
Epoch cpu Time(s): 7.8777

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00022 | Step 00000 | Loss 0.0194 | Train Acc 0.9119 | Speed (samples/sec) 32966.6444 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.60523935 ms
avg iteration GPU training time:312.67690485 ms
avg iteration (step) total cpu time:344.50286085 ms
Epoch cpu Time(s): 7.8179

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00023 | Step 00000 | Loss 0.0187 | Train Acc 0.9210 | Speed (samples/sec) 32970.0813 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.95428632 ms
avg iteration GPU training time:313.77671675 ms
avg iteration (step) total cpu time:345.70351514 ms
Epoch cpu Time(s): 7.7834

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00024 | Step 00000 | Loss 0.0186 | Train Acc 0.9186 | Speed (samples/sec) 32987.4428 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.27073461 ms
avg iteration GPU training time:326.35766047 ms
avg iteration (step) total cpu time:358.93162814 ms
Epoch cpu Time(s): 8.0621

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00025 | Step 00000 | Loss 0.0189 | Train Acc 0.9182 | Speed (samples/sec) 32952.9007 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.95861834 ms
avg iteration GPU training time:319.23121782 ms
avg iteration (step) total cpu time:350.24374182 ms
Epoch cpu Time(s): 7.8848

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00026 | Step 00000 | Loss 0.0180 | Train Acc 0.9211 | Speed (samples/sec) 32949.5158 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.57671270 ms
avg iteration GPU training time:315.71373402 ms
avg iteration (step) total cpu time:346.96626663 ms
Epoch cpu Time(s): 8.0263

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00027 | Step 00000 | Loss 0.0183 | Train Acc 0.9225 | Speed (samples/sec) 32942.6624 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.30364522 ms
avg iteration GPU training time:326.90526511 ms
avg iteration (step) total cpu time:358.95729065 ms
Epoch cpu Time(s): 8.0129

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00028 | Step 00000 | Loss 0.0185 | Train Acc 0.9168 | Speed (samples/sec) 32912.8173 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.72688016 ms
avg iteration GPU training time:338.89204545 ms
avg iteration (step) total cpu time:371.60875581 ms
Epoch cpu Time(s): 7.9768

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00029 | Step 00000 | Loss 0.0178 | Train Acc 0.9225 | Speed (samples/sec) 32883.2159 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.29902267 ms
avg iteration GPU training time:314.80812489 ms
avg iteration (step) total cpu time:348.89639508 ms
Epoch cpu Time(s): 7.9260

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00030 | Step 00000 | Loss 0.0190 | Train Acc 0.9172 | Speed (samples/sec) 32878.6667 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.57365539 ms
avg iteration GPU training time:321.49210982 ms
avg iteration (step) total cpu time:352.01085698 ms
Epoch cpu Time(s): 7.8531

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00031 | Step 00000 | Loss 0.0192 | Train Acc 0.9179 | Speed (samples/sec) 32884.7183 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:20.02755191 ms
avg iteration GPU training time:311.68363259 ms
avg iteration (step) total cpu time:344.69541636 ms
Epoch cpu Time(s): 7.7837

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00032 | Step 00000 | Loss 0.0188 | Train Acc 0.9216 | Speed (samples/sec) 32908.5814 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.23944430 ms
avg iteration GPU training time:319.86025724 ms
avg iteration (step) total cpu time:352.21385956 ms
Epoch cpu Time(s): 7.9961

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00033 | Step 00000 | Loss 0.0176 | Train Acc 0.9220 | Speed (samples/sec) 32901.1278 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.14592327 ms
avg iteration GPU training time:318.37731934 ms
avg iteration (step) total cpu time:355.29604825 ms
Epoch cpu Time(s): 8.0111

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00034 | Step 00000 | Loss 0.0184 | Train Acc 0.9210 | Speed (samples/sec) 32883.5441 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.30861976 ms
avg iteration GPU training time:309.99187678 ms
avg iteration (step) total cpu time:341.46449783 ms
Epoch cpu Time(s): 7.8009

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00035 | Step 00000 | Loss 0.0176 | Train Acc 0.9235 | Speed (samples/sec) 32900.7971 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.94458467 ms
avg iteration GPU training time:336.04336548 ms
avg iteration (step) total cpu time:369.62925304 ms
Epoch cpu Time(s): 8.1614

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00036 | Step 00000 | Loss 0.0175 | Train Acc 0.9239 | Speed (samples/sec) 32857.2397 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.40384293 ms
avg iteration GPU training time:312.69945179 ms
avg iteration (step) total cpu time:343.89940175 ms
Epoch cpu Time(s): 7.8238

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00037 | Step 00000 | Loss 0.0174 | Train Acc 0.9287 | Speed (samples/sec) 32875.4260 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.77318122 ms
avg iteration GPU training time:329.48343173 ms
avg iteration (step) total cpu time:364.01726983 ms
Epoch cpu Time(s): 8.1790

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00038 | Step 00000 | Loss 0.0183 | Train Acc 0.9210 | Speed (samples/sec) 32838.9399 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.34552149 ms
avg iteration GPU training time:322.43656228 ms
avg iteration (step) total cpu time:354.82131351 ms
Epoch cpu Time(s): 7.9879

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00039 | Step 00000 | Loss 0.0178 | Train Acc 0.9226 | Speed (samples/sec) 32828.8652 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.85616285 ms
avg iteration GPU training time:314.61753152 ms
avg iteration (step) total cpu time:345.74053504 ms
Epoch cpu Time(s): 7.7194

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00040 | Step 00000 | Loss 0.0179 | Train Acc 0.9233 | Speed (samples/sec) 32855.5203 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.52492211 ms
avg iteration GPU training time:314.94553445 ms
avg iteration (step) total cpu time:348.18443385 ms
Epoch cpu Time(s): 7.8989

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00041 | Step 00000 | Loss 0.0175 | Train Acc 0.9225 | Speed (samples/sec) 32857.6943 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.90170184 ms
avg iteration GPU training time:311.94076261 ms
avg iteration (step) total cpu time:348.05518931 ms
Epoch cpu Time(s): 7.7999

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00042 | Step 00000 | Loss 0.0177 | Train Acc 0.9224 | Speed (samples/sec) 32872.6218 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.35170902 ms
avg iteration GPU training time:332.14359075 ms
avg iteration (step) total cpu time:365.25806514 ms
Epoch cpu Time(s): 7.9280

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00043 | Step 00000 | Loss 0.0174 | Train Acc 0.9244 | Speed (samples/sec) 32864.2238 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.66379920 ms
avg iteration GPU training time:331.35589045 ms
avg iteration (step) total cpu time:363.75849897 ms
Epoch cpu Time(s): 8.1041

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00044 | Step 00000 | Loss 0.0176 | Train Acc 0.9259 | Speed (samples/sec) 32832.1947 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.00874450 ms
avg iteration GPU training time:315.04261086 ms
avg iteration (step) total cpu time:347.30828892 ms
Epoch cpu Time(s): 7.8053

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00045 | Step 00000 | Loss 0.0177 | Train Acc 0.9229 | Speed (samples/sec) 32837.1537 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.44212376 ms
avg iteration GPU training time:317.77081854 ms
avg iteration (step) total cpu time:350.84512017 ms
Epoch cpu Time(s): 7.9841

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00046 | Step 00000 | Loss 0.0184 | Train Acc 0.9194 | Speed (samples/sec) 32834.5826 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.38223683 ms
avg iteration GPU training time:337.20487560 ms
avg iteration (step) total cpu time:369.59136616 ms
Epoch cpu Time(s): 8.1584

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00047 | Step 00000 | Loss 0.0176 | Train Acc 0.9238 | Speed (samples/sec) 32799.7067 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.91880139 ms
avg iteration GPU training time:320.22690652 ms
avg iteration (step) total cpu time:350.94386881 ms
Epoch cpu Time(s): 7.8261

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00048 | Step 00000 | Loss 0.0175 | Train Acc 0.9241 | Speed (samples/sec) 32808.6968 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.88626914 ms
avg iteration GPU training time:301.08542702 ms
avg iteration (step) total cpu time:334.25387469 ms
Epoch cpu Time(s): 7.6472

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00049 | Step 00000 | Loss 0.0168 | Train Acc 0.9264 | Speed (samples/sec) 32839.1908 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.01447270 ms
avg iteration GPU training time:324.69217751 ms
avg iteration (step) total cpu time:355.57339408 ms
Epoch cpu Time(s): 8.1343

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00050 | Step 00000 | Loss 0.0176 | Train Acc 0.9212 | Speed (samples/sec) 32818.5782 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.76043927 ms
avg iteration GPU training time:335.20129949 ms
avg iteration (step) total cpu time:365.63327096 ms
Epoch cpu Time(s): 8.1712
Eval Acc 0.9139
Test Acc: 0.7548

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00051 | Step 00000 | Loss 0.0174 | Train Acc 0.9238 | Speed (samples/sec) 32804.5274 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.62344707 ms
avg iteration GPU training time:304.81539085 ms
avg iteration (step) total cpu time:337.58666299 ms
Epoch cpu Time(s): 7.8039

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00052 | Step 00000 | Loss 0.0176 | Train Acc 0.9230 | Speed (samples/sec) 32825.5332 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.13421093 ms
avg iteration GPU training time:300.13679366 ms
avg iteration (step) total cpu time:331.84489337 ms
Epoch cpu Time(s): 7.6821

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00053 | Step 00000 | Loss 0.0171 | Train Acc 0.9278 | Speed (samples/sec) 32865.5216 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.08932669 ms
avg iteration GPU training time:295.90939608 ms
avg iteration (step) total cpu time:323.94816659 ms
Epoch cpu Time(s): 7.9674

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00054 | Step 00000 | Loss 0.0171 | Train Acc 0.9237 | Speed (samples/sec) 32918.9112 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:14.96308934 ms
avg iteration GPU training time:296.78154963 ms
avg iteration (step) total cpu time:338.06154945 ms
Epoch cpu Time(s): 7.7154

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00055 | Step 00000 | Loss 0.0176 | Train Acc 0.9249 | Speed (samples/sec) 32952.8807 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.86082918 ms
avg iteration GPU training time:292.51914839 ms
avg iteration (step) total cpu time:321.64320079 ms
Epoch cpu Time(s): 7.6682

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00056 | Step 00000 | Loss 0.0177 | Train Acc 0.9216 | Speed (samples/sec) 32994.7167 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52392578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.78748504 ms
avg iteration GPU training time:311.53568615 ms
avg iteration (step) total cpu time:343.38550134 ms
Epoch cpu Time(s): 7.9446

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00057 | Step 00000 | Loss 0.0178 | Train Acc 0.9244 | Speed (samples/sec) 33001.2708 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.13380371 ms
avg iteration GPU training time:309.16821566 ms
avg iteration (step) total cpu time:337.08268946 ms
Epoch cpu Time(s): 7.8431

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00058 | Step 00000 | Loss 0.0175 | Train Acc 0.9246 | Speed (samples/sec) 33019.1129 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.86477965 ms
avg iteration GPU training time:294.87614580 ms
avg iteration (step) total cpu time:323.77966967 ms
Epoch cpu Time(s): 7.6803

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00059 | Step 00000 | Loss 0.0176 | Train Acc 0.9234 | Speed (samples/sec) 33059.4096 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.92647865 ms
avg iteration GPU training time:314.47855447 ms
avg iteration (step) total cpu time:343.65209666 ms
Epoch cpu Time(s): 7.8866

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00060 | Step 00000 | Loss 0.0169 | Train Acc 0.9257 | Speed (samples/sec) 33068.8139 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.20262684 ms
avg iteration GPU training time:315.23555964 ms
avg iteration (step) total cpu time:345.93889930 ms
Epoch cpu Time(s): 7.8216

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00061 | Step 00000 | Loss 0.0178 | Train Acc 0.9203 | Speed (samples/sec) 33083.9415 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.06660947 ms
avg iteration GPU training time:311.78547252 ms
avg iteration (step) total cpu time:342.16462482 ms
Epoch cpu Time(s): 7.9316

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00062 | Step 00000 | Loss 0.0175 | Train Acc 0.9218 | Speed (samples/sec) 33090.4281 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.71949369 ms
avg iteration GPU training time:310.68654563 ms
avg iteration (step) total cpu time:340.19624103 ms
Epoch cpu Time(s): 7.7801

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00063 | Step 00000 | Loss 0.0173 | Train Acc 0.9238 | Speed (samples/sec) 33112.4288 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.61173222 ms
avg iteration GPU training time:326.74047019 ms
avg iteration (step) total cpu time:354.52064601 ms
Epoch cpu Time(s): 8.2299

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52392578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00064 | Step 00000 | Loss 0.0162 | Train Acc 0.9271 | Speed (samples/sec) 33105.8806 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.11328576 ms
avg iteration GPU training time:317.98486606 ms
avg iteration (step) total cpu time:345.53961320 ms
Epoch cpu Time(s): 7.9741

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00065 | Step 00000 | Loss 0.0171 | Train Acc 0.9254 | Speed (samples/sec) 33110.4162 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.86438691 ms
avg iteration GPU training time:304.28201849 ms
avg iteration (step) total cpu time:333.50703933 ms
Epoch cpu Time(s): 7.7970

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00066 | Step 00000 | Loss 0.0174 | Train Acc 0.9223 | Speed (samples/sec) 33126.2089 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52392578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.20030282 ms
avg iteration GPU training time:306.91834328 ms
avg iteration (step) total cpu time:337.31759678 ms
Epoch cpu Time(s): 7.9097

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00067 | Step 00000 | Loss 0.0172 | Train Acc 0.9251 | Speed (samples/sec) 33136.1903 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.90320006 ms
avg iteration GPU training time:300.52757957 ms
avg iteration (step) total cpu time:328.98005572 ms
Epoch cpu Time(s): 7.7427

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00068 | Step 00000 | Loss 0.0168 | Train Acc 0.9267 | Speed (samples/sec) 33158.5890 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.19428383 ms
avg iteration GPU training time:298.27555986 ms
avg iteration (step) total cpu time:328.18410613 ms
Epoch cpu Time(s): 7.7164

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00069 | Step 00000 | Loss 0.0178 | Train Acc 0.9229 | Speed (samples/sec) 33186.0792 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.53419070 ms
avg iteration GPU training time:313.35477794 ms
avg iteration (step) total cpu time:342.40499410 ms
Epoch cpu Time(s): 7.9893

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00070 | Step 00000 | Loss 0.0171 | Train Acc 0.9255 | Speed (samples/sec) 33189.2356 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.92718523 ms
avg iteration GPU training time:318.69291826 ms
avg iteration (step) total cpu time:347.44908593 ms
Epoch cpu Time(s): 7.9443

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00071 | Step 00000 | Loss 0.0178 | Train Acc 0.9211 | Speed (samples/sec) 33193.1105 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52392578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.44062849 ms
avg iteration GPU training time:306.08284690 ms
avg iteration (step) total cpu time:334.87987518 ms
Epoch cpu Time(s): 7.9096

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00072 | Step 00000 | Loss 0.0163 | Train Acc 0.9275 | Speed (samples/sec) 33206.1517 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.94683335 ms
avg iteration GPU training time:310.97548884 ms
avg iteration (step) total cpu time:341.58511595 ms
Epoch cpu Time(s): 7.9287

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00073 | Step 00000 | Loss 0.0175 | Train Acc 0.9228 | Speed (samples/sec) 33214.7741 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52392578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:15.98898610 ms
avg iteration GPU training time:308.20177668 ms
avg iteration (step) total cpu time:337.08715439 ms
Epoch cpu Time(s): 7.7956

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00074 | Step 00000 | Loss 0.0165 | Train Acc 0.9262 | Speed (samples/sec) 33233.1583 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52392578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.89373094 ms
avg iteration GPU training time:292.20089999 ms
avg iteration (step) total cpu time:321.81297649 ms
Epoch cpu Time(s): 7.9799

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00075 | Step 00000 | Loss 0.0167 | Train Acc 0.9265 | Speed (samples/sec) 33254.7086 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.69516789 ms
avg iteration GPU training time:305.53163563 ms
avg iteration (step) total cpu time:340.16526829 ms
Epoch cpu Time(s): 7.8731

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00076 | Step 00000 | Loss 0.0163 | Train Acc 0.9272 | Speed (samples/sec) 33274.0142 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.59122614 ms
avg iteration GPU training time:296.97751964 ms
avg iteration (step) total cpu time:327.22978158 ms
Epoch cpu Time(s): 7.6725

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00077 | Step 00000 | Loss 0.0173 | Train Acc 0.9245 | Speed (samples/sec) 33296.2104 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.11387929 ms
avg iteration GPU training time:307.67608643 ms
avg iteration (step) total cpu time:338.77574314 ms
Epoch cpu Time(s): 7.9125

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00078 | Step 00000 | Loss 0.0163 | Train Acc 0.9295 | Speed (samples/sec) 33302.2314 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.18772958 ms
avg iteration GPU training time:305.94671353 ms
avg iteration (step) total cpu time:335.72582765 ms
Epoch cpu Time(s): 8.2910

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00079 | Step 00000 | Loss 0.0166 | Train Acc 0.9268 | Speed (samples/sec) 33315.2114 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:16.91644226 ms
avg iteration GPU training time:313.51096413 ms
avg iteration (step) total cpu time:343.09016575 ms
Epoch cpu Time(s): 7.9916

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00080 | Step 00000 | Loss 0.0162 | Train Acc 0.9286 | Speed (samples/sec) 33317.6074 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.70528863 ms
avg iteration GPU training time:334.71658325 ms
avg iteration (step) total cpu time:367.91344122 ms
Epoch cpu Time(s): 8.4835

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00081 | Step 00000 | Loss 0.0165 | Train Acc 0.9272 | Speed (samples/sec) 33285.7304 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.87483909 ms
avg iteration GPU training time:317.70589100 ms
avg iteration (step) total cpu time:350.82598166 ms
Epoch cpu Time(s): 7.9106

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00082 | Step 00000 | Loss 0.0163 | Train Acc 0.9292 | Speed (samples/sec) 33286.5978 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52001953125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51025390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47314453125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49658203125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 19.52197265625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 19.51220703125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 19.51416015625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 19.47509765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 19.49853515625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.72089299 ms
avg iteration GPU training time:314.83958019 ms
avg iteration (step) total cpu time:345.96824646 ms
Epoch cpu Time(s): 7.8083

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00083 | Step 00000 | Loss 0.0172 | Train Acc 0.9242 | Speed (samples/sec) 33290.0193 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:17.95581956 ms
avg iteration GPU training time:337.97864602 ms
avg iteration (step) total cpu time:368.70995435 ms
Epoch cpu Time(s): 8.2179

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00084 | Step 00000 | Loss 0.0170 | Train Acc 0.9222 | Speed (samples/sec) 33267.7148 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:19.75232887 ms
avg iteration GPU training time:341.81556563 ms
avg iteration (step) total cpu time:375.17361207 ms
Epoch cpu Time(s): 8.2256

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00085 | Step 00000 | Loss 0.0176 | Train Acc 0.9207 | Speed (samples/sec) 33242.1191 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.38070384 ms
avg iteration GPU training time:321.96277133 ms
avg iteration (step) total cpu time:354.86047918 ms
Epoch cpu Time(s): 7.9699

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00086 | Step 00000 | Loss 0.0170 | Train Acc 0.9232 | Speed (samples/sec) 33238.4117 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.23298055 ms
avg iteration GPU training time:315.48967674 ms
avg iteration (step) total cpu time:347.17243368 ms
Epoch cpu Time(s): 7.8590

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00087 | Step 00000 | Loss 0.0168 | Train Acc 0.9266 | Speed (samples/sec) 33236.3347 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.85290475 ms
avg iteration GPU training time:319.52312400 ms
avg iteration (step) total cpu time:351.50423917 ms
Epoch cpu Time(s): 7.9494

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00088 | Step 00000 | Loss 0.0164 | Train Acc 0.9259 | Speed (samples/sec) 33231.4390 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.87842352 ms
avg iteration GPU training time:320.47397128 ms
avg iteration (step) total cpu time:353.68050228 ms
Epoch cpu Time(s): 7.8312

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00089 | Step 00000 | Loss 0.0172 | Train Acc 0.9260 | Speed (samples/sec) 33228.4834 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.79693673 ms
avg iteration GPU training time:317.17927413 ms
avg iteration (step) total cpu time:353.28600623 ms
Epoch cpu Time(s): 7.8811

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00090 | Step 00000 | Loss 0.0171 | Train Acc 0.9229 | Speed (samples/sec) 33228.2172 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

avg iteration(step) data from cpu to GPU time:18.88306306 ms
avg iteration GPU training time:323.55102262 ms
avg iteration (step) total cpu time:357.23551837 ms
Epoch cpu Time(s): 7.9459

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

Epoch 00091 | Step 00000 | Loss 0.0172 | Train Acc 0.9266 | Speed (samples/sec) 33217.5825 | GPU 17162.7 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.760406017303467  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.760406017303467  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:19.32932628 ms
avg iteration GPU training time:324.27033303 ms
avg iteration (step) total cpu time:356.19410602 ms
Epoch cpu Time(s): 8.0875

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

Epoch 00092 | Step 00000 | Loss 0.0163 | Train Acc 0.9278 | Speed (samples/sec) 33206.4157 | GPU 17164.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:18.74655117 ms
avg iteration GPU training time:314.24239557 ms
avg iteration (step) total cpu time:346.88971259 ms
Epoch cpu Time(s): 7.8925

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

Epoch 00093 | Step 00000 | Loss 0.0172 | Train Acc 0.9257 | Speed (samples/sec) 33203.6034 | GPU 17164.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:16.16731349 ms
avg iteration GPU training time:297.91792436 ms
avg iteration (step) total cpu time:327.24293795 ms
Epoch cpu Time(s): 7.6517

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

Epoch 00094 | Step 00000 | Loss 0.0172 | Train Acc 0.9260 | Speed (samples/sec) 33221.8758 | GPU 17164.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:16.62132333 ms
avg iteration GPU training time:299.20742243 ms
avg iteration (step) total cpu time:329.80864698 ms
Epoch cpu Time(s): 8.5809

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

Epoch 00095 | Step 00000 | Loss 0.0161 | Train Acc 0.9282 | Speed (samples/sec) 33235.9359 | GPU 17164.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:16.27503447 ms
avg iteration GPU training time:297.57826926 ms
avg iteration (step) total cpu time:327.27941600 ms
Epoch cpu Time(s): 7.5552

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

Epoch 00096 | Step 00000 | Loss 0.0160 | Train Acc 0.9271 | Speed (samples/sec) 33256.5636 | GPU 17164.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:15.49582802 ms
avg iteration GPU training time:296.02946056 ms
avg iteration (step) total cpu time:325.06207986 ms
Epoch cpu Time(s): 7.6417

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

Epoch 00097 | Step 00000 | Loss 0.0159 | Train Acc 0.9303 | Speed (samples/sec) 33271.3361 | GPU 17164.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:15.38871271 ms
avg iteration GPU training time:294.34578913 ms
avg iteration (step) total cpu time:326.63674788 ms
Epoch cpu Time(s): 7.4982

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

Epoch 00098 | Step 00000 | Loss 0.0172 | Train Acc 0.9249 | Speed (samples/sec) 33293.8757 | GPU 17164.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:16.26011077 ms
avg iteration GPU training time:297.58130438 ms
avg iteration (step) total cpu time:326.28378001 ms
Epoch cpu Time(s): 7.6449

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

Epoch 00099 | Step 00000 | Loss 0.0169 | Train Acc 0.9252 | Speed (samples/sec) 33314.5227 | GPU 17164.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:15.94082329 ms
avg iteration GPU training time:322.62851784 ms
avg iteration (step) total cpu time:352.08190571 ms
Epoch cpu Time(s): 8.0164

   ***************************     step   0   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

Epoch 00100 | Step 00000 | Loss 0.0178 | Train Acc 0.9230 | Speed (samples/sec) 33309.3847 | GPU 17164.4 MB

   ***************************     step   1   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   2   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   3   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   4   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   5   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   6   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   7   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38134765625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   8   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39111328125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   9   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   10   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   11   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   12   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   13   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   14   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34423828125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36767578125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes


   ***************************     step   15   *************************************
-----------------------------------------step start------------------------
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------before blocks to device
Nvidia-smi: 20.34619140625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after blocks to device
Nvidia-smi: 20.36962890625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch train
Nvidia-smi: 20.39306640625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss
Nvidia-smi: 20.38330078125GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch loss backward
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

-----------------------------------------after batch optimizer step
Nvidia-smi: 20.38525390625GB	
Max Memory Allocated 16.762128353118896  GigaBytes

avg iteration(step) data from cpu to GPU time:16.06735134 ms
avg iteration GPU training time:319.11897694 ms
avg iteration (step) total cpu time:348.47051447 ms
Epoch cpu Time(s): 7.9942
Eval Acc 0.9156
Test Acc: 0.7539
Avg cpu epoch time: 7914.311463634173 ms
total avg iteration(step) data from cpu to GPU time:17.88094260 ms
total avg iteration GPU training time:315.53933708 ms
total avg iteration (step) total cpu time:347.37167243 ms
